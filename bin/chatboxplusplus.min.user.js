// ==UserScript==
// @name        Chatbox++
// @description Adds a number of 'universal' enhancements for the AIM Games chatbox. Warning: This script is still in active development and may contain bugs!
// @namespace   the_thrasher@gmail.com
// @include     http://aimgames.forummotion.com/
// @version     1.44
// @grant       none
// @license     MIT License (Expat); opensource.org/licenses/MIT
// ==/UserScript==
'use strict';var c,d,e,f,g,h;function k(){if(void 0!==window.scrollY)return window.scrollY;if("undefined"!==typeof window.pageYOffset)return window.pageYOffset;var b=document.documentElement;return b.clientHeight?b.scrollTop:document.body.scrollTop}var MutationObserver=window.MutationObserver||window.WebKitMutationObserver;
(new MutationObserver(function(){for(var b=0;b<d.length;b++)try{var a=d[b].getElementsByClassName("msg")[0].children[0];0<a.children.length?"hoo"!=a.children[0].innerHTML.toLowerCase()&&"cookie"!=a.children[0].innerHTML.toLowerCase()&&"hoo cookie"!=a.children[0].innerHTML.toLowerCase()&&"cookie hoo"!=a.children[0].innerHTML.toLowerCase()||d[b].parentNode.removeChild(d[b]):"hoo"!=a.innerHTML.toLowerCase()&&"cookie"!=a.innerHTML.toLowerCase()&&"hoo cookie"!=a.innerHTML.toLowerCase()&&"cookie hoo"!=
a.innerHTML.toLowerCase()||d[b].parentNode.removeChild(d[b])}catch(u){}for(b=0;b<d.length;b++)if(a=d[b],a=a.getElementsByClassName("date-and-time")[0].innerHTML.substring(1,a.getElementsByClassName("date-and-time")[0].innerHTML.length-1),a=a.substring(6,8),"11"==a||"22"==a||"33"==a||"44"==a||"55"==a||"66"==a||"77"==a||"88"==a||"99"==a||"00"==a)a=document.createElement("span"),a.style="color: red; text-align: right; display: block; float: right;",a.innerHTML=" CHECK 'EM",d[b].appendChild(a)})).observe(document,
{subtree:!0,attributes:!1,childList:!0,characterData:!0,attributeOldValue:!1,characterDataOldValue:!1});var l;0<$("#i_logo").length&&$("#i_logo").a("src","http://i.imgur.com/LjuijqL.png");
if(0<$("#frame_chatbox").length){l=$("#frame_chatbox")[0].contentWindow.document;c=$(l).find("#chatbox");d=c.children();e=1;l=$("#frame_chatbox")[0];g=document.createElement("div");g.className="ribbon";h=document.createElement("span");g.appendChild(h);var m;if(m=document.getElementsByTagName("head")[0]){var n=document.createElement("style");n.type="text/css";n.innerHTML="@import url('http://fonts.googleapis.com/css?family=Noto+Sans:400,700');.box{width: 0px;height: 0px;position: relative;border: 0px solid #BBB;background: #EEE;font-family: 'Noto Sans', sans-serif}.ribbon{width: 200px;background: #e43;position: absolute;top: 0px;left: -10px;text-align: center;line-height: 50px;letter-spacing: 1px;color: #ff0000;font-size: 18px}.ribbon span{width: 200px;background: #e43;position: absolute;top: 25px;left: -50px;text-align: center;line-height: 50px;letter-spacing: 1px;color: #f0f0f0;transform: rotate(-45deg);-webkit-transform: rotate(-45deg);font-size: 18px}.ribbon span::before{content: \"\";position:absolute;left:0px;top:100%;z-index:-1;border-left:3px solid #8F0808;border-right:3px solid transparent;border-bottom:3px solid transparent;border-top:3px solid #8F0808}.ribbon span::after{content:\"\";position:absolute;right:0px;top:100%;z-index:-1;border-left:3px solid transparent;border-right:3px solid #8F0808;border-bottom:3px solid transparent;border-top:3px solid #8F0808}";
m.appendChild(n)}f=$(document.body).append('<div class="box" style="position: fixed;left: 1%;top: 2%;"></div>');setInterval(function(){console.log("is at cbox - "+k()+" new msgs - "+(d.length-e));1400>=k()&&(h.innerHTML=1===d.length-e?"1 new msg":d.length-e+" new msgs",0<d.length-e?void 0===f.children[0]&&f.appendChild(g):void 0!==f.children[0]&&f.removeChild(g))},1E3);$(document).scroll(function(){1400<k()&&(e=d.length,void 0!==f.children[0]&&f.removeChild(g));var b=$("#box"),a=k();0<b.length&&(28>=
a?b.a("style","top: 30px;"):b.a("style","top: "+(a+2)+"px;"))});var p=document.createElement("span");p.innerHTML=" | ";var q=document.createElement("a");q.href="javascript:void(0)";var r=document.createElement("span");r.id="alive-refreshbutton";r.style="";r.onclick="chatbox.refresh()";r.innerHTML="Refresh";q.appendChild(r);var t=l.getElementById("chatbox_display_archives");t.appendChild(q);t.appendChild(p)}else throw"running in frame";